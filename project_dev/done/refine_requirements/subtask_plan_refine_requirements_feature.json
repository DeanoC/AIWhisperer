{
  "description": "Develop a high-level plan for the refine requirements feature, including CLI design and AI interaction.",
  "depends_on": [],
  "agent_spec": {
    "type": "planning",
    "input_artifacts": [
      "project_dev/rfc/refine_requirements.md",
      "docs/configuration.md",
      "src/ai_whisperer/main.py"
    ],
    "output_artifacts": [
      "project_dev/in_dev/refine_requirements/plan_summary.md"
    ],
    "instructions": [
      "Carefully review the requirements outlined in 'project_dev/rfc/refine_requirements.md'.",
      "Examine the existing configuration documentation ('docs/configuration.md') and the main CLI entry point ('src/ai_whisperer/main.py') to understand current patterns and conventions.",
      "Design the command-line interface for the new 'refine' feature. This should include the command name, required arguments (e.g., input file path), and optional arguments (e.g., output directory, iteration count). Ensure consistency with existing AIWhisperer CLI commands.",
      "Outline the complete workflow for the 'refine' command: how the tool will read the content of the specified input file (likely a markdown file), how it will prepare this content for interaction with the AI model, how it will interact with the AI (referencing potential API calls or internal processing), and how it will save the refined output.",
      "Specifically detail the file renaming and iteration numbering logic. The plan should describe how subsequent refinements of the same file will be handled (e.g., appending an iteration number like `requirements_v1.md`, `requirements_v2.md`).",
      "Document the entire plan, including the CLI design, workflow, and file handling logic, in the file 'project_dev/in_dev/refine_requirements/plan_summary.md'."
    ],
    "constraints": [
      "The CLI design must strictly adhere to the patterns and conventions used by existing AIWhisperer commands documented in 'docs/configuration.md' and implemented in 'src/ai_whisperer/main.py'.",
      "All file read and write operations within the workflow must include robust error handling to prevent data loss or unexpected behavior.",
      "The plan must clearly define the structure and content of the output file(s) generated by the refinement process."
    ],
    "validation_criteria": [
      "The file 'project_dev/in_dev/refine_requirements/plan_summary.md' must be created.",
      "The 'plan_summary.md' file must contain a clear and detailed specification of the proposed 'refine' CLI command, including all arguments and their purpose.",
      "The 'plan_summary.md' file must provide a step-by-step outline of the file processing and AI interaction flow, from reading the input to saving the output.",
      "The 'plan_summary.md' file must explicitly describe the logic for handling multiple refinements of the same input file, including the file renaming and iteration numbering scheme."
    ]
  },
  "step_id": "plan_refine_requirements_feature",
  "task_id": "45512229-1ac2-4ee7-a859-5c5ff96118d1",
  "subtask_id": "4705ce97-690d-42ce-8eaf-f51f149524b8"
}